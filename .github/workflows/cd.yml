build-and-deploy: # ðŸš€ CD (Continuous Deployment)
  needs: build-and-test   # faqat testlar oâ€˜tgandan keyin ishlaydi
  runs-on: ubuntu-latest
  steps:
    - name: Deploy to Production via SSH (Docker)
      if: github.ref == 'refs/heads/master'
      uses: appleboy/ssh-action@v1.0.0
      with:
        host: ${{ secrets.SSH_HOST }}
        username: ${{ secrets.SSH_USERNAME }}
        key: ${{ secrets.SSH_KEY }}
        port: 22
        script: |
          cd /var/www/Block
          git fetch origin || true
          git reset --hard origin/master || true
          git remote remove origin || true
          git remote add origin https://github.com/itsjasminn/Bloog.git
          git pull origin master
          # ðŸ”¹ Docker build & run
          docker compose down
          docker compose build --no-cache
          docker compose up -d
